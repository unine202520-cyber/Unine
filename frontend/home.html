<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>U9</title>

  <!-- CSS 部分 --> 
  <link rel="stylesheet" href="Home/home.css">
  <link rel="stylesheet" href="About/about.css">
  <link rel="stylesheet" href="Order/order.css">
  <link rel="stylesheet" href="Message/message.css">
  <link rel="stylesheet" href="Me/me.css">
  <link rel="stylesheet" href="Button/button.css">

  <!-- Supabase SDK -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <!-- 全局 Supabase 初始化 -->
  <script src="../supabaseClient.js"></script>
</head>
<body>

  <!-- 首页 -->
  <div id="homePage" class="page active">🏠 HOME</div>

  <!-- 信息页面 -->
  <div id="infoPage" class="page">
    <div class="message-header">
      <h2>💬 MESSAGE</h2>
      <button id="openChatBtn">
        ⛑︎
        <span id="chatBtnUnreadCount" class="unread-dot hidden">0</span>
      </button>
    </div>

    <!-- 聊天窗口 -->
    <div id="chatWindow" class="chat-window hidden">
      <div class="chat-header">
        <button id="backBtn">⬅ 返回</button>
        <h3>客服聊天</h3>
      </div>
      <div id="chatMessages" class="chat-messages"></div>
      <div class="chat-input">
        <input type="text" id="chatInput" placeholder="输入消息..." />
        <button id="sendBtn">发送</button>
      </div>
    </div>
  </div>
   
  <!-- 订单页面 -->
  <div id="orderPage" class="page">
    <div class="order-header">
      <h2>📦 ORDER</h2>
      <div id="roundProgress" style="margin-bottom: 10px; font-weight: bold;">
        本轮完成订单：加载中...
      </div>
      <div class="coins-box">
        💰 Coins: <span id="ordercoins">0</span>
        <button id="addCoinsBtn" title="从余额兑换Coins">+</button>
      </div>
    </div>

    <div class="order-actions">
      <button id="autoOrderBtn">🎲 一键刷单</button>
      <p id="cooldownDisplay" style="color:red; font-weight:bold;"></p>
    </div>

    <div id="matchingGif" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); z-index:999;">
      <img src="https://ffdrwsemmfvqlqhyjlnb.supabase.co/storage/v1/object/public/Product%20Photos/Qbox.gif" alt="正在匹配..." style="width:150px; height:150px;">
    </div>

    <div id="orderResult" class="order-result"></div>

    <div class="order-history">
      <h3>🕘 最近订单</h3>
      <ul id="recentOrders">
        <li>暂无订单！</li>
      </ul>
    </div>

    <!-- Balance / Coins 兑换弹窗 -->
    <div id="addCoinsModal" class="modal">
      <div class="modal-content">
        <h3>兑换 Coins / Balance</h3>

        <!-- 横排切换按钮 -->
        <div class="exchange-toggle">
          <button id="balanceToCoinsBtn" class="exchange-btn active" data-type="toCoins">Balance → Coins</button>
          <button id="coinsToBalanceBtn" class="exchange-btn" data-type="toBalance">Coins → Balance</button>
        </div>

        <p>请输入要兑换的数量：</p>
        <input type="number" id="addCoinsInput" min="1" placeholder="输入数量" />

        <div class="modal-actions">
          <button id="cancelExchange">取消</button>
          <button id="confirmExchange">确认</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 关于我们页面 -->
  <div id="msgPage" class="page">ℹ️ 关于我们</div>

  <!-- 我的页面 -->
  <div id="myPage" class="page">
    <h2>👤 我的页面</h2>

    <div class="user-info">
      <p class="username"><strong>用户名：</strong><span id="username">加载中...</span></p>
      <p class="platform"><strong>平台账号：</strong><span id="platformAccount">加载中...</span></p>
    </div>

    <div class="balance-box">
      <p><strong>Balance：</strong><span id="balance">0.00</span></p>
      <div class="balance-actions">
        <button id="depositBtn">充值</button>
        <button id="withdrawBtn">提现</button>
      </div>
    </div>

    <div class="my-buttons">
      <button id="logoutBtn">Logout</button>
    </div>
  </div>

  <!-- Logout 确认弹窗 -->
  <div id="logoutModal" class="modal">
    <div class="modal-content">
      <p>确定要退出吗？</p>
      <button id="cancelLogout">否</button>
      <button id="confirmLogout">确定</button>
    </div>
  </div>

  <!-- 提现弹窗 -->
  <div id="withdrawModal" class="modal">
    <div class="modal-content">
      <h3>提现</h3>
      <p>当前余额：<span id="withdrawBalance">0.00</span></p>
      <input type="number" id="withdrawAmount" placeholder="输入提现金额" />
      <input type="text" id="walletAddress" placeholder="USDT-TRC20钱包地址" />
      <button id="setPasswordBtn">添加提现密码</button>
      <div class="modal-actions">
        <button id="cancelWithdraw">取消</button>
        <button id="confirmWithdraw">提交</button>
      </div>
    </div>
  </div>

  <!-- 设置密码弹窗 -->
  <div id="setPasswordModal" class="modal">
    <div class="modal-content">
      <h3>设置提现密码</h3>
      <input type="text" id="withdrawPwd" maxlength="6" placeholder="输入6位数字密码" />
      <input type="text" id="confirmWithdrawPwd" maxlength="6" placeholder="确认密码" />
      <div class="modal-actions">
        <button id="cancelSetPwd">取消</button>
        <button id="saveWithdrawPwd">保存</button>
      </div>
    </div>
  </div>

  <!-- 更新密码弹窗 -->
  <div id="updatePasswordModal" class="modal">
    <div class="modal-content">
      <h3>更改提现密码</h3>
      <input type="text" id="oldWithdrawPwd" maxlength="6" placeholder="输入原密码" />
      <input type="text" id="newWithdrawPwd" maxlength="6" placeholder="输入新密码" />
      <input type="text" id="confirmNewWithdrawPwd" maxlength="6" placeholder="确认新密码" />
      <div class="modal-actions">
        <button id="cancelUpdatePwd">取消</button>
        <button id="saveUpdatePwd">保存</button>
      </div>
    </div>
  </div>

  <!-- 确认提现密码弹窗 -->
  <div id="confirmPwdModal" class="modal">
    <div class="modal-content">
      <h3>输入提现密码</h3>
      <input type="text" id="inputWithdrawPwd" maxlength="6" placeholder="请输入密码" />
      <div class="modal-actions">
        <button id="cancelConfirmPwd">取消</button>
        <button id="submitWithdrawFinal">提交</button>
      </div>
    </div>
  </div>

  <!-- 充值弹窗 -->
  <div id="rechargeModal" class="modal">
    <div class="modal-content">
      <h3>充值</h3>
      <input type="file" id="fileInput" />
      <button id="uploadBtn">上传</button>
      <p id="status"></p>
      <div class="modal-actions">
        <button id="cancelRecharge">取消</button>
      </div>
    </div>
  </div>

  <!-- 底部导航栏 -->
  <div class="bottom-nav">
    <button data-page="homePage" class="active">Home</button>
    <button data-page="infoPage" id="messageBtn">
      Message
      <span id="bottomUnreadCount" class="unread-dot hidden">0</span>
    </button>
    <button data-page="orderPage">Order</button>
    <button data-page="msgPage">About</button>
    <button data-page="myPage">Me</button>
  </div>

  <!-- JS 部分 --> 
  <script src="Home/home.js"></script>
  <script src="Message/message.js"></script>
  <script src="Order/order.js"></script>
  <script src="About/about.js"></script>
  <script src="Me/me.js"></script>
  <script src="Button/button.js"></script>
  <script src="Recharge/recharge.js"></script>
</body>
</html>
